<script>
import Five from '@/assets/img/quiz/5.jpg'
import Four from '@/assets/img/quiz/4.png'
import Three from '@/assets/img/quiz/3.jpg'
import Two from '@/assets/img/quiz/2.jpg'
import Questions from '@/components/Quiz/Questions.js'

export default {
  name: 'Main',
  data() {
    return {
      Questions: Questions,
      state: 0,
      is_start: false,
      feedback: false,
      the_end: false,
      answers: [],
      user_answer: -1,
      user_text_answer: '',
      grade: 0,
      grade_title: '',
      Processed: false,
      img: null
    }
  },
  methods: {
    start() {
      this.is_start = true
    },
    answer() {
      if (Questions[this.state].type === 'Radio') {
        this.feedback = Questions[this.state].answers[this.user_answer].feedback
        if (Questions[this.state].answers[this.user_answer].is_true) {
          this.grade++
        }
      } else {
        if (Questions[this.state].answers.includes(this.user_text_answer.trim())) {
          this.grade++
          this.feedback = Questions[this.state].feedback.is_true
        } else {
          this.feedback = Questions[this.state].feedback.is_false
        }
      }

    },
    next() {
      if ((this.state + 1) < Questions.length) {
        ++this.state
        this.feedback = false
        this.Processed = false
        this.user_answer = -1
        this.user_text_answer = ''
      } else {
        this.the_end = true
        this.is_start = false
        if (this.grade > 8) {
          this.img = Five
          this.grade_title = '–í—ã ‚Äì –¥–æ–≤–æ–ª—å–Ω—ã–π –∫–æ—Ç'
          this.feedback = '–í—ã –∑–Ω–∞–µ—Ç–µ –Ω–∞—Å –ª—É—á—à–µ –≤—Å–µ—Ö! –í–æ—Ç –∫—Ç–æ –±—É–¥–µ—Ç –∏—Å–∫—Ä–µ–Ω–Ω–µ —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –∑–∞ –Ω–∞—Å, –≥–æ–≤–æ—Ä–∏—Ç—å —Ç–µ–ø–ª—ã–µ —Å–ª–æ–≤–∞ –∏ —Ä–∞—Å—Ç—Ä–æ–≥–∞–µ—Ç—Å—è –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è —á—É–≤—Å—Ç–≤. –í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∫—Ç–æ-—Ç–æ –∏–∑ –Ω–∞—à–∏—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏–ª–∏ –ª—É—á—à–∏—Ö –¥—Ä—É–∑–µ–π. –ù–æ —ç—Ç–æ –Ω–µ —Ç–æ—á–Ω–æ.'
        } else if (this.grade > 5) {
          this.img = Four
          this.grade_title = '–í—ã ‚Äì –∫–æ—Ç –°—Ç–µ–ø–∞–Ω'
          this.feedback = '–í—ã –≤–µ—Ä–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤, –¥–æ–≤–æ–ª—å–Ω—ã —Å–æ–±–æ–π –∏ —É–∂–µ –≥–æ—Ç–æ–≤—ã –∫ –ø—Ä–∞–∑–¥–Ω–∏–∫—É. –û—Ç–ª–∏—á–Ω–æ! –ñ–¥–∞—Ç—å –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ.'
        } else if (this.grade > 2) {
          this.img = Three
          this.grade_title = '–í—ã ‚Äì –∫–æ—Ç –ë–µ–Ω–¥–µ—Ä'
          this.feedback = '–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–µ–Ω—å—à–µ —á–µ–º –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É –≤–æ–ø—Ä–æ—Å–æ–≤ –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ —Å–æ–≥–ª–∞—Å–Ω—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏. –î–∞ –ª–∞–∞–¥–Ω–æ, –≤—ã –≤—Å–µ —Ä–∞–≤–Ω–æ —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å. –ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –Ω–∞ –Ω–∞—à–µ–º –ø—Ä–∞–∑–¥–Ω–∏–∫–µ!'
        } else {
          this.img = Two
          this.grade_title = '–í—ã ‚Äì –ø–ª–∞—á—É—â–∏–π –∫–æ—Ç–∏–∫'
          this.feedback = '–í–∞–º –∏–∑–≤–µ—Å—Ç–Ω–æ –æ –Ω–∞—Å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ, –Ω–æ –Ω–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å, —ç—Ç–æ—Ç —Ç–µ—Å—Ç —Å–¥–µ–ª–∞–Ω –∫–∞–∫ —Ä–∞–∑ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã —É–∑–Ω–∞–ª–∏ –Ω–∞—Å –ª—É—á—à–µ –∏ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å –Ω–∞—à–µ–π –∏—Å—Ç–æ—Ä–∏–µ–π! –ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –Ω–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–µ.'
        }
      }
    },
    reset() {
      this.is_start = true
      this.the_end = false
      this.grade = 0
      this.state = 0
      this.feedback = false
      this.Processed = false
      this.user_answer = -1
    }
  }
}
</script>

<template>
  <div class="quiz">
    <div class="quiz__wrapper">
      <div v-if="!is_start && !the_end" class="quiz__introduction">
        <div class="quiz__state"><span></span><span>–¢–µ—Å—Ç</span></div>
        <div v-if="!is_start" class="quiz__introduction__title">
          –ö–∞–∫–æ–π –≤—ã –≥–æ—Å—Ç—å?
        </div>
        <div v-if="!is_start" class="quiz__introduction__text">
          –®—É—Ç–æ—á–Ω—ã–π —Ç–µ—Å—Ç –æ&nbsp;—Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤—ã –Ω–∞—Å –∑–Ω–∞–µ—Ç–µ. –ù–µ –±–æ–π—Ç–µ—Å—å, –æ–Ω –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–Ω–∞–Ω–∏—è, –∏&nbsp;–æ—Ü–µ–Ω–∫–∏ –∑–∞
          –Ω–µ–≥–æ –Ω–µ —Å—Ç–∞–≤—è—Ç—Å—è. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —É–∑–Ω–∞—Ç—å –Ω–∞—Å —á—É—Ç—å –ª—É—á—à–µ üôÇ
        </div>
      </div>
      <div v-if="is_start">
        <div class="quiz__state"><span>{{ (state + 1) }}</span><span>/</span><span>{{ Questions.length }}</span></div>
        <div class="quiz__text">{{ Questions[this.state].text }}</div>
        <div class="quiz__answers">
          <div v-if="Questions[state].type === 'Radio'" class="quiz__answer"
               v-for="(answer, index) in Questions[this.state].answers">
            <label>
              <input v-model="user_answer" name="answers" type="radio" :value="index" :checked="this.Processed">
              {{ answer.text }}
            </label>
            <div class="quiz__answer__feedback" v-if="this.user_answer === index && feedback">
              {{ answer.feedback }}
            </div>
          </div>
          <div v-if="Questions[state].type === 'Text'" class="quiz__answer">
            <input type="text" name="answers" v-model="user_text_answer">
            <div class="quiz__answer__feedback2" v-if="feedback">
              {{ feedback }}
            </div>
          </div>
        </div>
      </div>
      <div class="quiz__grade" v-if="the_end">
        <img class="quiz__grade__img" :src="img" alt="!"><br>
        <div class="quiz__grade__result"><b>{{ this.grade }} / {{ Questions.length }}</b></div>
        <div class="quiz__grade__title"><b>{{ this.grade_title }}</b></div>
        <div class="quiz__grade__text">{{ this.feedback }}</div>
        <br>
      </div>
      <div class="quiz__btn">
        <div v-if="!is_start && !the_end">
          <button class="quiz-link" @click="start">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
        </div>
        <div v-if="!feedback && (user_answer !== -1 || user_text_answer)">
          <button class="quiz-link" @click="answer">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
        </div>
        <div v-if="feedback && !the_end">
          <button class="quiz-link" @click="next">–î–∞–ª–µ–µ</button>
        </div>
        <div v-if="feedback && the_end">
          <button class="quiz-link" @click="reset">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â—ë —Ä–∞–∑</button>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped lang="scss">
.quiz {
  &__introduction {
    text-align: center;

    &__title {
      margin-bottom: 20px;
      font-size: 28px;
      line-height: 1.17;
      font-weight: 600;
    }

    &__text {
      font-size: 16px;
      line-height: 1.55;
      font-weight: 300;
    }
  }

  &__wrapper {
    background-color: #ffffff;
    border-width: 1px;
    border-color: #9c9c9c;
    //border-radius: 30px;
    padding: 45px 45px 45px;
  }

  &__state {
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: 600;
    letter-spacing: 2.5px;
    text-align: center;

    span:first-child {
      opacity: .7;
    }

    span {
      opacity: .3;
    }
  }

  &__text {
    margin-bottom: 20px;
    text-align: left;
    font-weight: 600;
  }

  &__answers {
  }

  &__answer {
    padding: 15px 0;

    &__feedback, &__feedback2 {
      opacity: .8;
      font-size: 14px;
    }

    &__feedback {
      padding-left: 30px;
    }

    &__feedback2 {
    }

    input[type='text'] {
      border: 1px solid #9c9c9c;
      height: 40px;
    }

    input[type='radio'],
    label {
      cursor: pointer;
    }

    $size: 18px;

    input[type='radio'] {
      top: 2px;
      position: relative;
      height: $size;
      width: $size;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      outline: none;
    }

    input[type='radio']::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: $size;
      height: $size;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      border: 1px solid #8aaf7a;
    }

    input[type='radio']:checked::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: calc($size / 2);
      height: calc($size / 2);
      border-radius: 50%;
      background-color: #8aaf7a;
      transform: translate(-50%, -50%);
      visibility: visible;
    }

    input[type='radio']:disabled {
      opacity: .3;
    }
  }

  &__grade {
    margin: 0 auto;

    &__result {
      text-align: center;
      font-size: 24px;
      padding-bottom: 10px;
    }

    &__title {
    }

    &__img {
      max-width: 300px;
      width: 100%;
      margin: 0 auto;
    }
  }

  &__btn {
    padding-top: 10px;
    display: flex;
    justify-content: center;
  }

}
</style>